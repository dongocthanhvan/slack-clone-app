(this["webpackJsonpsocial-media-app"]=this["webpackJsonpsocial-media-app"]||[]).push([[0],{182:function(e,n,t){},185:function(e,n,t){},186:function(e,n,t){},187:function(e,n,t){},193:function(e,n,t){},194:function(e,n,t){},195:function(e,n,t){},197:function(e,n,t){},199:function(e,n,t){"use strict";t.r(n);var a=t(4),c=t(1),r=t.n(c),s=t(48),i=t.n(s),o=t(224),l=t(225),u=t(226),j=t(70),d=t(217),h=t(160),f=t(41),b=t(132);t(179),t(180),t(181);b.a.initializeApp({apiKey:"AIzaSyDGMrXZ1ob-bFqTGaQUI0nAlZR2IH7wPBg",authDomain:"slack-cloning-react.firebaseapp.com",projectId:"slack-cloning-react",storageBucket:"slack-cloning-react.appspot.com",messagingSenderId:"64237170097",appId:"1:64237170097:web:9a487ab56d032bcbd06190",measurementId:"G-ZFZVL7W4HG"}),b.a.analytics();var m=b.a,O=(t(182),Object(f.b)((function(e){return{user:e.user.currentUser}}))((function(e){var n=function(){m.auth().signOut().then((function(){return console.log("user signed out")}))};return e.user?Object(a.jsx)(l.a,{children:Object(a.jsx)(l.a.Column,{children:Object(a.jsxs)(l.a.Row,{className:"userinfo_grid_row",children:[Object(a.jsxs)(u.a,{inverted:!0,as:"h2",children:[Object(a.jsx)(j.a,{name:"slack"}),Object(a.jsx)(u.a.Content,{children:"Slack"})]}),Object(a.jsx)(u.a,{className:"userinfo_displayname",inverted:!0,as:"h4",children:Object(a.jsx)(d.a,{trigger:Object(a.jsxs)("span",{children:[Object(a.jsx)(h.a,{src:e.user.photoURL,avatar:!0}),e.user.displayName]}),options:[{key:"signout",text:Object(a.jsx)("span",{onClick:n,children:"Sign Out"})}]})})]})})}):null}))),p=t(42),g=t(123),x=t(16),v=t(144),C=t(220),w=t(218),y=t(223),k=t(200),S="SET_USER",U="SET_CHANNEL",N="SET_FAVOURITECHANNEL",I="REMOVE_FAVOURITECHANNEL",E=(t(185),Object(f.b)((function(e){return{user:e.user.currentUser,channel:e.channel.currentChannel}}),(function(e){return{selectChannel:function(n){return e(function(e){return{type:U,payload:{currentChannel:e}}}(n))}}}))((function(e){var n=Object(c.useState)(!1),t=Object(x.a)(n,2),r=t[0],s=t[1],i=Object(c.useState)({name:"",description:""}),l=Object(x.a)(i,2),u=l[0],d=l[1],h=Object(c.useState)(!1),f=Object(x.a)(h,2),b=f[0],O=f[1],S=Object(c.useState)([]),U=Object(x.a)(S,2),N=U[0],I=U[1],E=m.database().ref("channels");Object(c.useEffect)((function(){return E.on("child_added",(function(n){I((function(t){var a=Object(g.a)(t);return a.push(n.val()),a.length>=0&&e.selectChannel(a[0]),a}))})),function(){return E.off()}}),[]);var A=function(){s(!1)},P=function(){var n=E.push().key,t={id:n,name:u.name,description:u.description,created_by:{name:e.user.displayName,avatar:e.user.photoURL}};O(!0),E.child(n).update(t).then((function(){d({name:"",description:""}),O(!1),A()})).catch((function(e){console.log(e)}))},R=function(e){var n=e.target;d((function(e){var t=Object(p.a)({},e);return t[n.name]=n.value,t}))};return Object(a.jsxs)(a.Fragment,{children:[" ",Object(a.jsxs)(o.a.Menu,{children:[Object(a.jsxs)(o.a.Item,{children:[Object(a.jsxs)("span",{children:[Object(a.jsx)(j.a,{name:"exchange"})," Channels"]}),"(",N.length,")"]}),function(){if(N.length>0)return N.map((function(n){return Object(a.jsx)(v.a,{name:n.name,onClick:function(){return e.selectChannel(n)},active:n.id===e.channel.id},n.id)}))}(),Object(a.jsx)(o.a.Item,{children:Object(a.jsxs)("span",{className:"clickable",onClick:function(){s(!0)},children:[Object(a.jsx)(j.a,{name:"add"}),"ADD"]})})]}),Object(a.jsxs)(C.a,{open:r,onClose:A,children:[Object(a.jsx)(C.a.Header,{children:"Create Channel"}),Object(a.jsx)(C.a.Content,{children:Object(a.jsx)(w.a,{onSubmit:P,children:Object(a.jsxs)(y.a,{stacked:!0,children:[Object(a.jsx)(w.a.Input,{name:"name",value:u.name,onChange:R,type:"text",placeholder:"Enter Channel Name"}),Object(a.jsx)(w.a.Input,{name:"description",value:u.description,onChange:R,type:"text",placeholder:"Enter Channel Description"})]})})}),Object(a.jsxs)(C.a.Actions,{children:[Object(a.jsxs)(k.a,{loading:b,onClick:P,children:[Object(a.jsx)(j.a,{name:"checkmark"}),"Save"]}),Object(a.jsxs)(k.a,{onClick:A,children:[Object(a.jsx)(j.a,{name:"remove"}),"Cancel"]})]})]})]})}))),A=(t(186),function(){return Object(a.jsxs)(o.a,{vertical:!0,fixed:"left",borderless:!0,size:"large",className:"side_bar",children:[Object(a.jsx)(O,{}),Object(a.jsx)(E,{})]})}),P=t(215),R=function(e){return Object(a.jsxs)(y.a,{clearing:!0,children:[Object(a.jsx)(u.a,{floated:"left",as:"h2",children:Object(a.jsxs)("span",{children:[e.channelName,Object(a.jsx)(j.a,{onClick:e.starChange,name:e.starred?"star":"star outline",color:e.starred?"yellow":"black"})]})}),Object(a.jsx)(u.a,{floated:"right",children:Object(a.jsx)(P.a,{name:"search",icon:"search",placeholder:"Search Messages",size:"mini",onChange:e.searchTermChange})})]})},L=t(219),T=t(216),_=t(158);t(187);T.a.locale(_);var M=new T.a,F=function(e){return Object(a.jsxs)(L.a,{children:[Object(a.jsx)(L.a.Avatar,{src:e.message.user.avatar}),Object(a.jsxs)(L.a.Content,{className:e.ownMessage?"ownMessage":null,children:[Object(a.jsx)(L.a.Author,{as:"a",children:e.message.user.name}),Object(a.jsx)(L.a.Metadata,{children:M.format(e.message.timestamp)}),e.message.image?Object(a.jsx)(h.a,{onLoad:e.imageLoaded,src:e.message.image}):Object(a.jsx)(L.a.Text,{children:e.message.content})]})]})},H=t(141),W=t.n(H),D=function(e){var n=Object(c.useState)(null),t=Object(x.a)(n,2),r=t[0],s=t[1],i=["image/png","image/jpeg"];return Object(a.jsxs)(C.a,{open:e.open,onClose:e.onClose,children:[Object(a.jsx)(C.a.Header,{children:"Select a image"}),Object(a.jsx)(C.a.Content,{children:Object(a.jsx)(P.a,{type:"file",name:"file",onChange:function(e){var n=e.target.files[0];n&&s(n)},label:"File Type (png,jpeg)"})}),Object(a.jsxs)(C.a.Actions,{children:[Object(a.jsxs)(k.a,{onClick:function(){r&&i.includes(W.a.lookup(r.name))&&(e.uploadImage(r,W.a.lookup(r.name)),e.onClose(),s(null))},children:[Object(a.jsx)(j.a,{name:"checkmark"}),"Add"]}),Object(a.jsxs)(k.a,{onClick:e.onClose,children:[Object(a.jsx)(j.a,{name:"remove"}),"Cancel"]})]})]})},G=t(159),V=t.n(G),z=Object(f.b)((function(e){return{user:e.user.currentUser,channel:e.channel.currentChannel}}))((function(e){var n=m.database().ref("messages"),t=m.storage().ref(),r=Object(c.useState)(""),s=Object(x.a)(r,2),i=s[0],o=s[1],l=Object(c.useState)(!1),u=Object(x.a)(l,2),j=u[0],d=u[1],h=function(t){(i||t)&&n.child(e.channel.id).push().set(function(n){return{user:{avatar:e.user.photoURL,name:e.user.displayName,id:e.user.uid},content:i,image:n||"",timestamp:m.database.ServerValue.TIMESTAMP}}(t)).then((function(){return o("")})).catch((function(e){return console.log(e)}))};return Object(a.jsxs)(y.a,{children:[Object(a.jsx)(P.a,{onChange:function(e){var n=e.target;o(n.value)},fluid:!0,name:"message",value:i,label:Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(k.a,{icon:"send",onClick:function(){h()}}),Object(a.jsx)(k.a,{icon:"upload",onClick:function(){return d(!0)}})]}),labelPosition:"right"}),Object(a.jsx)(D,{uploadImage:function(e,n){var a="chat/images/".concat(V()(),".jpg");t.child(a).put(e,{contentType:n}).then((function(e){e.ref.getDownloadURL().then((function(e){h(e)})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}))},open:j,onClose:function(){return d(!1)}})]})})),B=(t(193),Object(f.b)((function(e){return{channel:e.channel.currentChannel,user:e.user.currentUser,favouriteChannels:e.favouriteChannel.favouriteChannel}}),(function(e){return{setfavouriteChannel:function(n){return e(function(e){return{type:N,payload:{favouriteChannel:e}}}(n))},removefavouriteChannel:function(n){return e(function(e){return{type:I,payload:{favouriteChannel:e}}}(n))}}}))((function(e){var n,t=m.database().ref("messages"),r=m.database().ref("users"),s=Object(c.useState)([]),i=Object(x.a)(s,2),o=i[0],l=i[1],u=Object(c.useState)(""),j=Object(x.a)(u,2),d=j[0],h=j[1];Object(c.useEffect)((function(){if(e.channel)return l([]),t.child(e.channel.id).on("child_added",(function(e){l((function(n){var t=Object(g.a)(n);return t.push(e.val()),t}))})),function(){return t.child(e.channel.id).off()}}),[e.channel]),Object(c.useEffect)((function(){if(e.user)return r.child(e.user.uid).child("favourite").on("child_added",(function(n){e.setfavouriteChannel(n.val())})),r.child(e.user.uid).child("favourite").on("child_removed",(function(n){e.removefavouriteChannel(n.val())})),function(){return r.child(e.user.uid).child("favourite").off()}}),[e.user]);var f=function(){var e=new RegExp(d,"gi");return o.reduce((function(n,t){return(t.content.match(e)||t.user.name.match(e))&&n.push(t),n}),[])},b=function(){var n;return Object.keys(e.favouriteChannels).includes(null===(n=e.channel)||void 0===n?void 0:n.id)};return Object(a.jsxs)("div",{className:"messages",children:[Object(a.jsx)(R,{starChange:function(){var n=r.child(e.user.uid).child("favourite").child(e.channel.id);b()?n.remove():n.set({channelId:e.channel.id,channelName:e.channel.name})},starred:b(),searchTermChange:function(e){var n=e.target;h(n.value)},channelName:null===(n=e.channel)||void 0===n?void 0:n.name}),Object(a.jsx)(y.a,{className:"messagecontent",children:Object(a.jsx)(L.a.Group,{children:function(){var n=d?f():o;if(n.length>0)return n.map((function(n){var t;return Object(a.jsx)(F,{ownMessage:n.user.id===(null===(t=e.user)||void 0===t?void 0:t.uid),message:n},n.timestamp)}))}()})}),Object(a.jsx)(z,{})]})})));t(194);console.warn=function(){};var Z=function(){return Object(a.jsxs)(l.a,{columns:"equal",children:[Object(a.jsx)(A,{}),Object(a.jsx)(l.a.Column,{className:"messagepanel",children:Object(a.jsx)(B,{})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var q=t(17),J=t(84),K=t(74),Q=t(221),X=(t(195),function(){var e=m.database().ref("users"),n=Object(c.useState)({username:"",email:"",password:"",confirmpassword:""}),t=Object(x.a)(n,2),r=t[0],s=t[1],i=Object(c.useState)([]),o=Object(x.a)(i,2),d=o[0],h=o[1],f=Object(c.useState)(!1),b=Object(x.a)(f,2),O=b[0],g=b[1],v=Object(c.useState)(!1),C=Object(x.a)(v,2),S=C[0],U=C[1],N=function(e){var n=e.target;s((function(e){var t=Object(p.a)({},e);return t[n.name]=n.value,t}))},I=function(){return!r.username.length||!r.password.length||!r.confirmpassword.length||!r.email.length},E=function(){return r.password.length<8?(h((function(e){return e.concat({message:"Password length should be greater than 8"})})),!1):r.password===r.confirmpassword||(h((function(e){return e.concat({message:"Password and Confirm Password does not match"})})),!1)},A=function(e){e&&(g(!0),e.user.updateProfile({displayName:r.username,photoURL:"http://gravatar.com/avatar"}).then((function(){g(!1),P(e)})).catch((function(e){g(!1),h((function(n){return n.concat(e)}))})))},P=function(n){g(!0),e.child(n.user.uid).set({displayName:n.user.displayName,photoURL:n.user.photoURL}).then((function(){g(!1),U(!0)})).catch((function(e){g(!1),h((function(n){return n.concat(e)}))}))};return Object(a.jsx)(l.a,{verticalAlign:"middle",textAlign:"center",className:"grid-form",children:Object(a.jsxs)(l.a.Column,{style:{maxWidth:"500px"},children:[Object(a.jsxs)(u.a,{icon:!0,as:"h2",children:[Object(a.jsx)(j.a,{name:"slack"}),"Register"]}),Object(a.jsxs)(w.a,{onSubmit:function(e){h((function(){return[]})),U(!1),(I()?(h((function(e){return e.concat({message:"Please fill in all fields"})})),0):E())&&(g(!0),m.auth().createUserWithEmailAndPassword(r.email,r.password).then((function(e){g(!1),A(e),console.log("fiwefiwef"),window.location.reload()})).catch((function(e){g(!1),h((function(n){return n.concat(e)}))})))},children:[Object(a.jsxs)(y.a,{stacked:!0,children:[Object(a.jsx)(w.a.Input,{name:"username",value:r.username,icon:"user",iconPosition:"left",onChange:N,type:"text",placeholder:"User Name"}),Object(a.jsx)(w.a.Input,{name:"email",value:r.email,icon:"mail",iconPosition:"left",onChange:N,type:"email",placeholder:"User Email"}),Object(a.jsx)(w.a.Input,{name:"password",value:r.password,icon:"lock",iconPosition:"left",onChange:N,type:"password",placeholder:"User Password"}),Object(a.jsx)(w.a.Input,{name:"confirmpassword",value:r.confirmpassword,icon:"lock",iconPosition:"left",onChange:N,type:"password",placeholder:"Confirm Password"})]}),Object(a.jsx)(k.a,{disabled:O,loading:O,children:"Submit"})]}),d.length>0&&Object(a.jsxs)(Q.a,{error:!0,children:[Object(a.jsx)("h3",{children:"Errors"}),d.map((function(e,n){return Object(a.jsx)("p",{children:e.message},n)}))]}),S&&Object(a.jsx)(Q.a,{success:!0,children:Object(a.jsx)("h3",{children:"Successfully Registered"})}),Object(a.jsxs)(Q.a,{children:["Already an User? ",Object(a.jsx)(J.b,{to:"/login",children:"Login "})]})]})})}),$=(t(197),function(){var e=Object(c.useState)({email:"",password:""}),n=Object(x.a)(e,2),t=n[0],r=n[1],s=Object(c.useState)(!1),i=Object(x.a)(s,2),o=i[0],d=i[1],h=Object(c.useState)([]),f=Object(x.a)(h,2),b=f[0],O=f[1],g=function(e){var n=e.target;r((function(e){var t=Object(p.a)({},e);return t[n.name]=n.value,t}))},v=function(){return!t.password.length||!t.email.length};return Object(a.jsx)(l.a,{verticalAlign:"middle",textAlign:"center",className:"grid-form",children:Object(a.jsxs)(l.a.Column,{style:{maxWidth:"500px"},children:[Object(a.jsxs)(u.a,{icon:!0,as:"h2",children:[Object(a.jsx)(j.a,{name:"slack"}),"Login"]}),Object(a.jsxs)(w.a,{onSubmit:function(e){O((function(){return[]})),v()&&(O((function(e){return e.concat({message:"Please fill in all fields"})})),1)||(d(!0),m.auth().signInWithEmailAndPassword(t.email,t.password).then((function(e){d(!1),console.log(e)})).catch((function(e){d(!1),O((function(n){return n.concat(e)}))})))},children:[Object(a.jsxs)(y.a,{stacked:!0,children:[Object(a.jsx)(w.a.Input,{name:"email",value:t.email,icon:"mail",iconPosition:"left",onChange:g,type:"email",placeholder:"User Email"}),Object(a.jsx)(w.a.Input,{name:"password",value:t.password,icon:"lock",iconPosition:"left",onChange:g,type:"password",placeholder:"User Password"})]}),Object(a.jsx)(k.a,{disabled:o,loading:o,children:"Login"})]}),b.length>0&&Object(a.jsxs)(Q.a,{error:!0,children:[Object(a.jsx)("h3",{children:"Errors"}),b.map((function(e,n){return Object(a.jsx)("p",{children:e.message},n)}))]}),Object(a.jsxs)(Q.a,{children:["Not an User? ",Object(a.jsx)(J.b,{to:"/register",children:"Register "})]})]})})}),Y={currentUser:null},ee={currentChannel:null},ne={favouriteChannel:{}},te=Object(K.b)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y,n=arguments.length>1?arguments[1]:void 0;if(n.type===S){var t=n.payload;return e=Object(p.a)({},t)}return e},channel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ee,n=arguments.length>1?arguments[1]:void 0;if(n.type===U){var t=n.payload;return e=Object(p.a)({},t)}return e},favouriteChannel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ne,n=arguments.length>1?arguments[1]:void 0;if(n.type===N){var t=n.payload.favouriteChannel,a=Object(p.a)({},e.favouriteChannel);return a[t.channelId]=t.channelName,{favouriteChannel:a}}if(n.type===I){var c=n.payload.favouriteChannel,r=Object(p.a)({},e.favouriteChannel);return delete r[c.channelId],{favouriteChannel:r}}return e}}),ae=(t(198),Object(K.c)(te));console.log(ae.getState());var ce=Object(q.f)(Object(f.b)((function(e){return{currentUser:e.user.currentUser}}),(function(e){return{setUser:function(n){e(function(e){return{type:S,payload:{currentUser:e}}}(n))}}}))((function(e){return Object(c.useEffect)((function(){m.auth().onAuthStateChanged((function(n){console.log(n),n?(e.setUser(n),e.history.push("/")):(e.setUser(null),e.history.push("/login"))}))}),[]),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(q.c,{children:[Object(a.jsx)(q.a,{path:"/login",component:$}),Object(a.jsx)(q.a,{path:"/register",component:X}),Object(a.jsx)(q.a,{path:"/",component:Z})]})})})));i.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(f.a,{store:ae,children:Object(a.jsx)(J.a,{children:Object(a.jsx)(ce,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[199,1,2]]]);
//# sourceMappingURL=main.88dbe4b3.chunk.js.map